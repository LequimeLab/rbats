# Introduction
**r-bats** (Bayesian Analysis of Tip Significance in R) is an R library for the analysis of phylogenetic data. It asks the question: 'given this distribution of traits on taxa, how likely is this pattern to have arisen by chance?'. It assumes discrete trait values, known for each taxon unambiguously. The phylogenetic relationship between the taxa must be represented as a posterior set of trees, e.g. a collection of trees assumed to correctly sample the posterior distribution of the phylogeny. Usually these will have been inferred from molecular data using [BEAST](https://www.beast2.org/) or [MrBayes](http://mrbayes.sourceforge.net/). This library is uses the same methods as the java package [befi-bats](https://github.com/lonelyjoeparker/befi-bats-gui) which is a further development of the approach described in [Parker _et al._ (2008)](https://www.sciencedirect.com/science/article/pii/S1567134807001128?via%3Dihub). It should return the same results given the same input, though this R library does not require any manual modifying of the input files.


# Requirements
R version 4.0.0 or above is required to download this package. The package "devtools" is needed to be able to download packages off of github. The package itself uses the libraries [ape](https://cran.r-project.org/web/packages/ape/index.html) and [TreeTools](https://cran.r-project.org/web/packages/TreeTools/index.html). These dependencies should be automatically downloaded.


# Instalation
To install this package, the devtools package needs to be installed and then used like this:
```
devtools::install_github("slequime/rbats")
```

# Usage
The only function a user needs to call to use this package is `bats()`. This function can take four arguments:

| Argument  | Optional | Description                                                                                          |
|-----------|----------|------------------------------------------------------------------------------------------------------|
| treefile  | No       | The path to the .trees or .tre file generated by BEAST                                               |
| xmlfile   | No       | The path to the .xml file                                                                            |
| reps      | Yes      | An integer indicating how many shuffled trees should be generated for each normal tree               |
| userinput | Yes      | Which attribute should be used as the state attribute                                                |
| PS_method | Yes      | Which method for the parsimony score should be used, either "legacy" or "fitch" (default = "legacy") |

Examples:
```
treefile <- "path/to/files/treefile.trees"
xmlfile <- "path/to/files/xmlfile.xml"

bats(treefile, xmlfile, reps=10)

bats(treefile, xmlfile, reps=10, userinput="state_attribute", PS_method="fitch")
```


# Help and instructions
This repository contains a pdf file "Function Guide". This guide should answer most questions about how this package works. 
If something is wrong with the package or calculations, or something should be added to this package you can contact me at i.j.a.pool@st.hanze.nl







